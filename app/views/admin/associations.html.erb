<% if user_signed_in? && current_user.isAdmin? %>
  <main class="wrapper" id="sidenav-container">
    <%= render partial: 'sidenav', :locals => {:sect => "associations"} %>
    <section id="associations-admin">
      <header>
        <button type="button" class="sidenav-toggler" onclick="toggleSideNav()">
          <i class="fa fa-caret-left show-left"></i> 
          <i class="fa fa-navicon"></i> 
          <i class="fa fa-caret-right show-right"></i>
        </button>
        <h2>Associations <i class="fa fa-exchange"></i></h2>
        <%= admin_notice(@team_testlines, "associations", notice) %>
      </header>
      <div class="card-deck">
        <% @testlines.each do |testline| %>
          <div class="card">
            <div class="card-content">
              <div class="card-header bg-blue">
                <div class="status-circle bg-green">
                  <i class="fa fa-check fa-white"></i>
                </div>
                <i class="fa fa-server testline-icon text-white"></i>
                <div class="card-header-overlay">
                	<%= content_tag :h3, testline.name %>
                  <%= button_add_association testline.id %>
                </div>
              </div>
            	<div class="card-body">
              	<%= show_associations_teams testline %>
              </div>
            </div>
          </div>
          <%= content_tag :div, :class => "modal", :id => testline.id do %>
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="modal-title">Pick a Team</h4>
                <%= content_tag :button, '&times;'.html_safe, :class => "modal-close", :onclick => "deactivate_modal(#{testline.id})", :type => "button" %>
              </div>
              <div class="modal-body" >
								<div class="outer-border-hidden">
									<ul class="pokeballs-grid pokeballs-grid-sm">
										<%= t = teams_without_access testline %>
									</ul>
								</div>
                <div>
               	  <% if t.blank? %>
                    <p class="card-text">All teams are already able to use this testline.</p>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    </section>
  </main>
	<div class="modal" id="remove_access">
	    <div class="modal-confirm">
	      <div class="modal-header">
	          <button type="button" class="modal-close" onclick="cancel_modal()">&times;</button>
	          <h3 class="modal-title"><i class="fa fa-trash"></i> Delete</h3>
	      </div>
	      <div class="modal-body">
	        <p class="modal-text">Are you sure you want to remove this team's access from this testline?</p>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="modal-btn bg-red" onclick="confirm_modal()">Delete</button>
	        <button type="button" class="modal-btn" onclick="cancel_modal()">Cancel</button>
	      </div>
	  </div>
	</div>
<% else %>
  <%= render 'error' %>
<% end %>